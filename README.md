# Forge University

This project contains a Forge app written in Javascript that displays `Hello World!` in a Jira issue panel. 

See [developer.atlassian.com/platform/forge/](https://developer.atlassian.com/platform/forge) for documentation and tutorials explaining Forge.

## Requirements

See [Set up Forge](https://developer.atlassian.com/platform/forge/set-up-forge/) for instructions to get set up.

## How to

1. After setting up your development environment, run `forge create` from your terminal.
2. Name your app. eg `hello-university`
3. Select `Jira` as your context
4. Select `UI Kit` as your category
5. Select `jira-issue-panel` as your template 
    (see below for an example of what you'll see in the terminal window)

    ```bash
    mpaisley@L2917Y9CXH Forge University % forge create

    Creating an app in your current directory:

        /Users/mpaisley/Atlassian/Projects/Forge University

    Press Ctrl+C to cancel.

    Name your app. The app name can include dashes, spaces, and underscores.

    ? Enter a name for your app: university

    Start with a template. Each template contains the required files to be a valid app.

    ? Select a context: Jira
    ? Select a category: UI Kit
    ? Select a template: jira-issue-panel

    ✔ Creating app...

    ℹ Downloading template
    ℹ Registering app
    ℹ Creating environments
    ℹ Installing dependencies

    ✔ Created university

    Your app is ready to work on, deploy, and install. We created 3 environments you can deploy to: production, staging, development.

    Change to directory university to see your app files.
    ```
6. Once your app has been created, you can open the app directory in your preferred IDE. For example visual studio code. 
7. **Usually here you'd:** 
    * Explain the app structure and what has been generated by the app template,
    * Explain how to run `forge deploy` and `forge install` to deploy and install the application to the `development` environment. 
    * Explain how to access the Jira issue panel from the cloud development site. 
8. For demonstration sake, this app will use a **data file** with the **upcoming vacation / holiday dates** for the team.  *In the future you could extend the app to add an admin screen that allowed users to add and store upcoming holidays, or even connect the app with an online API that obtained holiday data.*  In the `src/frontend` directory, create a new file called `data.jsx` and add the following data:
    ```javascript
    export const holidays = [
      {
        id: 1,
        date: "2025-01-01",
        title: "New Years Day",
        description: "Our team will be out on vacation for New Year's Day. Our regular SLA will resume on January 2nd.", 
      },
      {
        id: 2,
        date: "2025-05-22",
        title: "Memorial Day",
        description: "Our team will be out on vacation for Memorial Day. Our regular SLA will resume on May 27th.",   },
      {
        id: 3,
        date: "2025-07-04",
        title: "Independence Day",
        description: "Our team will be out on vacation for Independence Day. Our regular SLA will resume on July 5th.",   
      },
      {
        id: 4,
        date: "2025-09-01",
        title: "Labor Day",
        description: "Our team will be out on vacation for Labor Day. Our regular SLA will resume on September 2nd.",   
      },
      {
        id: 5,
        date: "2025-11-27",
        title: "Thanksgiving Day",
        description: "Our team will be out on vacation for Thanksgiving. Our regular SLA will resume on Friday 28th.",   
      },    
      {
        id: 6,
        date: "2025-12-25",
        title: "Christmas Day",
        description: "Our team will be out on vacation for Christmas Day. Our regular SLA will resume on December 26th.",   
      }, 
    ]
    ```
   Feel free to modify these dates, and add some of your own.  Save the file. 
9. Now, open the `src/frontend/index.jsx` file. This file is where you'll define the user interface (also known as frontend) of your app. To make the holidday data accessible in your app, add a new import below `import ForgeReconciler, { Text } from '@forge/react'` as follows:
    ```javascript
    import { holidays } from './data';
    ```
10. Create a function that will use [Javascript Date](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date) to determine the current date, and then check if any of the holidays in the specified file fall within the next 14 days:
    ```javascript
    const checkUpcomingHolidays = () => {
        let upcomingHolidaysTemp = [];

        /* Use the JavaScript Date object to get the current date and store as 'today'. */
        let t = Date.now();
        let today = new Date(t);
        /* Use the JavaScript Date object to get the date 7 days from now and store it as 'nextTwoWeek'. */
        let n = Date.parse(new Date(today.getFullYear(), today.getMonth(), today.getDate() + 14));
        let nextTwoWeek = new Date(n);

        for (let index = 0; index < holidays.length; index++) {
          /* Use the Javascript Date object to convert the date in our holidays object to a Date so it can be compared to the current date and next week. */
          let holidayDate = new Date(holidays[index].date);
          
          if((holidayDate > today)&&(holidayDate < nextTwoWeek) )
          /* if the holiday date is after today, and less than a week away, add it to the array of upcoming holidays */
          {
              upcomingHolidaysTemp.push(holidays[index]);
          }
        }
        return(upcomingHolidaysTemp);
    }
    ```
    This function will return an array of holidays falling in the next 14 days.
11. Now, call the `checkUpcomingHolidays` function from the `App`. Add the following line on the first line after the App function declaration:
    ```javascript
      let upcomingHolidays = checkUpcomingHolidays();
    ```
11. In addition to the `<Text>` component, you will also need to use the `Heading` component. In your `src/frontend/index.jsx` add `Heading` to the imports from `@forge/react` as follows:
      ```
      import ForgeReconciler, { Heading, Text } from '@forge/react';
      ```
    Hint: I like to keep these in Alphabetical order to make it easier to check for components later. 
12. Modify the `return` for the main `App` to display each of the upcoming holidays.  A nice way to do this is using the [Javascript map method](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map), since the holidays are in an array:
    ```javascript
      return (
        <>
            {upcomingHolidays.map((holiday) => (
              <>
                  <Heading size="small">{holiday.title}</Heading>
                  <Text>{holiday.description}</Text>
              </>
            ))}
        </>
      );
    ```  
    This will display a Heading with the holidays title, followed by Text with the holidays description for each of the upcoming Holidays. 
14. **Usually here you'd explain how to start the Tunnel, and check that the changes were working in your cloud site.**
13. It would help to also display the date for the upcoming holiday in human readable format along with the title and description, to do this, create a new function as follows:
    ```javascript
    const showDateString = (date) => {
      let localisedDate = new Date(date).toDateString();
      return(localisedDate);
    }
    ```
15. Modify the `<Heading...>` in the App return to include the DateString as follows:
    ```javascript
              <Heading size="small">{ showDateString(holiday.date) } - {holiday.title}</Heading>
    ```
    Save the changes to `index.jsx` and reload your jira issue screen to check the changes are working in the app. 
16. Now, you will use the [Box component](https://developer.atlassian.com/platform/forge/ui-kit/components/box/) to improve the formatting of the holidays in the app:  
    * In your `src/frontend/index.jsx` add `Box` to the imports from `@forge/react` as follows:
        ```javascript
        import ForgeReconciler, { Box, Heading, Text } from '@forge/react';
        ```
    * In the `App` return, add a `<box>` element to surround the Heading and Text as follows: 
        ```javascript
          return (
            <>
                {upcomingHolidays.map((holiday) => (
                  <>
                    <Box padding="space.050">
                      <Heading size="small">{ showDateString(holiday.date) } - {holiday.title}</Heading>
                      <Text>{holiday.description}</Text>
                    </Box>
                  </>
                ))}
            </>
          );
        ```
      This will create some extra space between each of the holidays.  Why not try experimenting with other formatting changes using Box?  
    * Test your changes by saving `index.jsx` and reloading your jira issue view. 
17. Close your `forge tunnel` using `Ctrl + c` and then run forge deploy to deploy your changes to the development environment. 

Congratulations! You're done - why not take a moment to celebrate with a cuppa. 


### Quick guide to working with Forge apps

- Modify your app frontend by editing the `src/frontend/index.jsx` file.

- Modify your app backend by editing the `src/resolvers/index.js` file to define resolver functions. See [Forge resolvers](https://developer.atlassian.com/platform/forge/runtime-reference/custom-ui-resolver/) for documentation on resolver functions.

- Build and deploy your app by running:
```
forge deploy
```

- Install your app in an Atlassian site by running:
```
forge install
```

- Develop your app by running `forge tunnel` to proxy invocations locally:
```
forge tunnel
```

### Notes
- Use the `forge deploy` command when you want to persist code changes.
- Use the `forge install` command when you want to install the app on a new site.
- Once the app is installed on a site, the site picks up the new app changes you deploy without needing to rerun the install command.

## Support

See [Get help](https://developer.atlassian.com/platform/forge/get-help/) for how to get help and provide feedback.
